{"version":3,"file":"form.min.js","sources":["../src/form.js"],"sourcesContent":["define(['jquery', 'core/ajax', 'core/templates', 'core/notification'],\nfunction($, Ajax, Templates, Notification) {\n    return {\n        init: function(courseid) {\n            const validPositions = ['Goalkeeper', 'Defender', 'Midfielder', 'Forward'];\n            // Load form data and render template.\n            Ajax.call([{\n                methodname: 'local_soccerteam_get_form_data',\n                args: {courseid: courseid},\n                done: function(data) {\n                    data.courseid = courseid;\n                    Templates.render('local_soccerteam/form', data).then(function(html){\n                        $('#formcontainer').html(html);\n\n                        $('#soccerteam-form').on('submit', function(e) {\n                            e.preventDefault();\n                            var userid = $('#userid').val();\n                            var position = $('#position').val();\n                            var jerseynumber = $('#jerseynumber').val();\n                            if (!userid || !position || !jerseynumber) {\n                                Notification.alert('', 'Please fill in all required fields');\n                                return;\n                            }\n\n                            // Validate position.\n                            if (!validPositions.includes(position)) {\n                                $('#status-message')\n                                    .removeClass('alert-success alert-info')\n                                    .addClass('alert-danger')\n                                    .text('Error: Invalid position selected')\n                                    .show();\n                                return;\n                            }\n                            $('#status-message')\n                                .removeClass('alert-danger alert-success')\n                                .addClass('alert-info')\n                                .text('Saving data...')\n                                .show();\n\n                            // Check for duplicate jersey number.\n                            Ajax.call([{\n                                methodname: 'local_soccerteam_check_jersey_number',\n                                args: {\n                                    courseid: parseInt(courseid),\n                                    userid: parseInt(userid),\n                                    jerseynumber: parseInt(jerseynumber)\n                                },\n                                done: function(response) {\n                                    if (response.duplicate) {\n                                        // Show error for duplicate jersey number\n                                        $('#status-message')\n                                            .removeClass('alert-success alert-info')\n                                            .addClass('alert-danger')\n                                            .text(response.message)\n                                            .show();\n                                    } else {\n                                        // Save data via AJAX if jersey number is not duplicate\n                                        savePlayerData(courseid, userid, position, jerseynumber);\n                                    }\n                                },\n                                fail: function(error) {\n                                    $('#status-message')\n                                        .removeClass('alert-success alert-info')\n                                        .addClass('alert-danger')\n                                        .text('Error checking jersey number: ' + error.message)\n                                        .show();\n                                    Notification.exception(error);\n                                }\n                            }]);\n                        });\n\n                        // Handle cancel button\n                        $('#cancel-btn').on('click', function() {\n                            $('#soccerteam-form')[0].reset();\n                            $('#status-message').hide();\n                        });\n                    }).fail(function(error) {\n                        Notification.exception(error);\n                    });\n                },\n                fail: function(error) {\n                    Notification.exception(error);\n                }\n            }]);\n\n            /**\n             * Save player data function\n             * @param {number} courseid - The course ID\n             * @param {number} userid - The user ID\n             * @param {string} position - The player position\n             * @param {number} jerseynumber - The jersey number\n             */\n            function savePlayerData(courseid, userid, position, jerseynumber) {\n                Ajax.call([{\n                    methodname: 'local_soccerteam_save_player_data',\n                    args: {\n                        courseid: parseInt(courseid),\n                        userid: parseInt(userid),\n                        position: position,\n                        jerseynumber: parseInt(jerseynumber)\n                    },\n                    done: function(response) {\n                        // Show success message\n                        $('#status-message')\n                            .removeClass('alert-danger alert-info')\n                            .addClass('alert-success')\n                            .text(response.message)\n                            .show();\n\n                        // Reset form after 2 seconds\n                        setTimeout(function() {\n                            $('#soccerteam-form')[0].reset();\n                            $('#status-message').hide();\n                        }, 2000);\n                    },\n                    fail: function(error) {\n                        $('#status-message')\n                            .removeClass('alert-success alert-info')\n                            .addClass('alert-danger')\n                            .text('Error saving data: ' + error.message)\n                            .show();\n                        Notification.exception(error);\n                    }\n                }]);\n            }\n        }\n    };\n});\n"],"names":["define","$","Ajax","Templates","Notification","init","courseid","validPositions","call","methodname","args","done","data","render","then","html","on","e","preventDefault","userid","val","position","jerseynumber","includes","removeClass","addClass","text","show","parseInt","response","duplicate","message","setTimeout","reset","hide","fail","error","exception","savePlayerData","alert"],"mappings":"AAAAA,+BAAO,CAAC,SAAU,YAAa,iBAAkB,sBACjD,SAASC,EAAGC,KAAMC,UAAWC,oBAClB,CACHC,KAAM,SAASC,gBACLC,eAAiB,CAAC,aAAc,WAAY,aAAc,WAEhEL,KAAKM,KAAK,CAAC,CACPC,WAAY,iCACZC,KAAM,CAACJ,SAAUA,UACjBK,KAAM,SAASC,MACXA,KAAKN,SAAWA,SAChBH,UAAUU,OAAO,wBAAyBD,MAAME,MAAK,SAASC,MAC1Dd,EAAE,kBAAkBc,KAAKA,MAEzBd,EAAE,oBAAoBe,GAAG,UAAU,SAASC,GACxCA,EAAEC,qBACEC,OAASlB,EAAE,WAAWmB,MACtBC,SAAWpB,EAAE,aAAamB,MAC1BE,aAAerB,EAAE,iBAAiBmB,MACjCD,QAAWE,UAAaC,aAMxBf,eAAegB,SAASF,WAQ7BpB,EAAE,mBACGuB,YAAY,8BACZC,SAAS,cACTC,KAAK,kBACLC,OAGLzB,KAAKM,KAAK,CAAC,CACPC,WAAY,uCACZC,KAAM,CACFJ,SAAUsB,SAAStB,UACnBa,OAAQS,SAAST,QACjBG,aAAcM,SAASN,eAE3BX,KAAM,SAASkB,UACPA,SAASC,UAET7B,EAAE,mBACGuB,YAAY,4BACZC,SAAS,gBACTC,KAAKG,SAASE,SACdJ,gBAsCTrB,SAAUa,OAAQE,SAAUC,cAChDpB,KAAKM,KAAK,CAAC,CACPC,WAAY,oCACZC,KAAM,CACFJ,SAAUsB,SAAStB,UACnBa,OAAQS,SAAST,QACjBE,SAAUA,SACVC,aAAcM,SAASN,eAE3BX,KAAM,SAASkB,UAEX5B,EAAE,mBACGuB,YAAY,2BACZC,SAAS,iBACTC,KAAKG,SAASE,SACdJ,OAGLK,YAAW,WACP/B,EAAE,oBAAoB,GAAGgC,QACzBhC,EAAE,mBAAmBiC,SACtB,MAEPC,KAAM,SAASC,OACXnC,EAAE,mBACGuB,YAAY,4BACZC,SAAS,gBACTC,KAAK,sBAAwBU,MAAML,SACnCJ,OACLvB,aAAaiC,UAAUD,WAhEPE,CAAehC,SAAUa,OAAQE,SAAUC,eAGnDa,KAAM,SAASC,OACXnC,EAAE,mBACGuB,YAAY,4BACZC,SAAS,gBACTC,KAAK,iCAAmCU,MAAML,SAC9CJ,OACLvB,aAAaiC,UAAUD,YAxC3BnC,EAAE,mBACGuB,YAAY,4BACZC,SAAS,gBACTC,KAAK,oCACLC,OAVLvB,aAAamC,MAAM,GAAI,yCAoD/BtC,EAAE,eAAee,GAAG,SAAS,WACzBf,EAAE,oBAAoB,GAAGgC,QACzBhC,EAAE,mBAAmBiC,aAE1BC,MAAK,SAASC,OACbhC,aAAaiC,UAAUD,WAG/BD,KAAM,SAASC,OACXhC,aAAaiC,UAAUD"}